<html>
<head>
    <script src="https://kit.fontawesome.com/0549145fa9.js" crossorigin="anonymous"></script>
    <title>Poligon remote control</title>
    <meta name="viewport" content="width=device-width, user-scalable=no" />
    <style>
    body {
        background-color: #404040;
        color: #b8b8b8;
        font-family: monospace;
        font-weight: bold;
        text-align:center;
    }
    .title {
        text-align: center;
        text-transform: uppercase;
    }
    .description {
        margin: 3px 0 -3px 15px;
    }
    .section {
        padding: 10px;
        margin: 10px;
        border: thin solid #15d32b;
        border-radius: 5px;
        width: 300px;
        display: inline-block;
        vertical-align: top;
        text-align: left;
    }
    .subsection {
        padding: 3px;
        margin: 0;
        border: thin solid #b8b8b8;
        border-radius: 5px;
    }
    .grid-table {
        display: grid;
        grid-template-columns: 1fr 1fr;
    }
    .left {
        grid-column: 1;
    }
    .right {
        grid-column: 2;
    }
    .center {
        grid-column: 1/3;
    }
    .btn {
        height: 120px;
        margin: 10px;
        border: solid 3px;
        border-color: #15d32b;
        background-color: green;
        color: #b8b8b8;
        font-weight: normal;
    }
    .btn.red {
        border-color: #ff0000;
        background-color: #8a0000;
    }
    .btn:active {
        border-color: green;
    }
    .fas{
        font-size: 3em;
    }
    .fab{
        font-size: 3em;
    }
    .icon{
        margin-left: 5px;
        margin-right: 5px;
    }
    </style>
</head>
<body>
    <span class="title"><h3>Poligon Remote Control</h3></span>
    <div id="radio" class="section">
        <div class="title">Audio</div>
        <div class="subsection">
            <div class="description">Volume</div>
            <div class="grid-table">
                <button class="left btn" onclick="fetch('/send?device=radio&button=vol-down')">
                    <i class="fas fa-volume-down"></i>
                </button>
                <button class="right btn" onclick="fetch('/send?device=radio&button=vol-up')">
                    <i class="fas fa-volume-up"></i>
                </button>
            </div>
        </div>
        <div class="subsection">
            <div class="description">Source</div>
            <div class="grid-table">
                <button class="left btn show"
                    onclick="fetch('/send?device=radio&button=aux'); fetch('/audioswitch?source=2');">
                    <i class="fas icon fa-tv"></i>
                </button>
                <button class="right btn show"
                    onclick="fetch('/send?device=radio&button=aux'); fetch('/audioswitch?source=1');">
                    <i class="fas icon fa-guitar"></i>
                </button>
                <button class="left btn show"
                    onclick="fetch('/send?device=radio&button=aux'); fetch('/audioswitch?source=3');">
                    <i class="fas icon fa-laptop"></i>
                </button>
                <button class="right btn" onclick="fetch('/send?device=radio&button=tuner')">
                    </i><i class="fas icon fa-broadcast-tower"></i>
                </button>
            </div>
        </div>
        <div class="subsection">
            <div class="description">Power off</div>
            <div class="grid-table">
                <button class="btn red center" onclick="fetch('/send?device=radio&button=power')">
                    <i class="fas icon fa-power-off"></i>
                </button>
            </div>
        </div>
    </div>
    <div id="tv" class="section">
        <div class="title">TV</div>
        <div class="subsection">
            <div class="description">Power on/off</div>
            <div class="grid-table">
                <button class="btn center" onclick="fetch('/send?device=tv&button=power')">
                    <i class="fas icon fa-power-off"></i>
                </button>
            </div>
        </div>
        <div class="subsection">
            <div class="description">Channel</div>
            <div class="grid-table">
                <button class="left btn" onclick="fetch('/send?device=tv&button=ch-down')">
                    <i class="fas fa-sort-numeric-down"></i>
                </button>
                <button class="right btn" onclick="fetch('/send?device=tv&button=ch-up')">
                    <i class="fas fa-sort-numeric-up"></i>
                </button>
            </div>
        </div>
        <div class="subsection">
            <div class="description">Source</div>
            <div class="grid-table">
                <button class="center btn" onclick="fetch('/send?device=tv&button=source')">
                    <i class="fab fa-usb"></i>
                </button>
                <button class="left btn" onclick="fetch('/send?device=tv&button=down')">
                    <i class="fas fa-chevron-down"></i>
                </button>
                <button class="right btn" onclick="fetch('/send?device=tv&button=up')">
                    <i class="fas fa-chevron-up"></i>
                </button>
            </div>
        </div>
        <div class="subsection">
            <div class="description">Volume</div>
            <div class="grid-table">
                <button class="left btn" onclick="fetch('/send?device=tv&button=vol-down')">
                    <i class="fas fa-volume-down"></i>
                </button>
                <button class="right btn" onclick="fetch('/send?device=tv&button=vol-up')">
                    <i class="fas fa-volume-up"></i>
                </button>
            </div>
        </div>
    </div>
    <div class="section">
        <div class="title">Lights</div>
        <div class="subsection">
            <div class="description">Balcony</div>
            <div class="grid-table">
                <button class="btn center" onclick='turnOnLights(this)'>
                    <i id="lights-loader" style="display:none" class="fas fa-spinner fa-spin"></i>
                    <i id="lights-icon" class="fas icon fa-power-off"></i>
                </button>
            </div>
        </div>
        <div class="subsection">
            <div class="description">Leds</div>
            <div class="grid-table">
                <input type="color" id="ledcolor" name="ledcolor" value="#000000">
                <input type="number" id="number" name="number" />
                <button class="btn center" onclick='turnOnLeds(this)'>
                    <i id="lights-icon" class="fas icon fa-power-off"></i>
                </button>
            </div>
            
        </div>
    </div>
    <script>
        function turnOnLights(button) {
            const loaderStyle = document.getElementById('lights-loader').style
            const iconStyle = document.getElementById('lights-icon').style
            loaderStyle.display = 'block'
            iconStyle.display = 'none'
            button.disabled = true

            fetch("http://192.168.0.213:2137/toggleLight", { mode: "no-cors"})
                .finally(() => {
                    loaderStyle.display = 'none'
                    iconStyle.display = 'block'
                    button.disabled = false
                })
        }

        function turnOnLeds(button) {
            const color = document.getElementById('ledcolor').value
            const number = document.getElementById('number').value

            const r = parseInt(color.substr(1,2), 16)
            const g = parseInt(color.substr(3,2), 16)
            const b = parseInt(color.substr(5,2), 16)

            for (let i=0; i<number && i <30; i++)
                fetch(`led?id=${i}&r=${r}&g=${g}&b=${b}`)
        }
    </script>
</body>
</html>